<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>馃┖ 讘讜讞专 讛转诪讞讜转 - 诪讞砖讘讜谉</title>
    
    <!-- Bootstrap 5 RTL -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #2874a6;
            --primary-dark: #153952;
            --accent: #f39c12;
            --success: #27ae60;
            --danger: #e74c3c;
            --gold: #ffd700;
            --silver: #c0c0c0;
            --bronze: #cd7f32;
        }
        
        * { 
            font-family: 'Heebo', 'Segoe UI', Tahoma, Arial, sans-serif; 
            box-sizing: border-box;
        }
        
        body { 
            background: linear-gradient(180deg, #f0f4f8 0%, #e8eef3 100%);
            min-height: 100vh;
            direction: rtl;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 25px 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
        }
        .header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin: 0;
        }
        .header p {
            opacity: 0.9;
            margin: 5px 0 0;
        }
        
        /* Cards */
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        .card:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        .card-header {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-bottom: 2px solid var(--primary);
            padding: 15px 20px;
        }
        .card-header h5 {
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        /* Sliders */
        /* Select Dropdowns Styling */
        .form-select {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            padding: 10px 15px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
        }
        .form-select:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 10px rgba(40, 116, 166, 0.15);
        }
        .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 4px 15px rgba(40, 116, 166, 0.25);
            outline: none;
        }
        .form-range {
            height: 10px;
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
        }
        .form-range::-webkit-slider-runnable-track {
            height: 10px;
            background: linear-gradient(90deg, #27ae60 0%, #f39c12 50%, #e74c3c 100%);
            border-radius: 6px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }
        .form-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            margin-top: -9px;
            background: linear-gradient(145deg, #4fc3f7 0%, #2196f3 30%, #1976d2 70%, #0d47a1 100%);
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 3px 12px rgba(0,0,0,0.35), inset 0 1px 2px rgba(255,255,255,0.4);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .form-range::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(0,0,0,0.4), inset 0 1px 2px rgba(255,255,255,0.4);
        }
        .form-range::-moz-range-track {
            height: 10px;
            background: linear-gradient(90deg, #27ae60 0%, #f39c12 50%, #e74c3c 100%);
            border-radius: 6px;
        }
        .form-range::-moz-range-thumb {
            width: 28px;
            height: 28px;
            background: linear-gradient(145deg, #4fc3f7 0%, #2196f3 30%, #1976d2 70%, #0d47a1 100%);
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 3px 12px rgba(0,0,0,0.35);
            cursor: pointer;
        }
        
        /* Custom Toggle Buttons */
        .toggle-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .toggle-btn {
            position: relative;
        }
        .toggle-btn input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-btn label {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #dee2e6;
            color: #495057;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        }
        .toggle-btn label:hover {
            border-color: var(--primary);
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 116, 166, 0.2);
        }
        .toggle-btn input[type="radio"]:checked + label {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-color: var(--primary-dark);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 116, 166, 0.4);
            transform: translateY(-2px);
        }
        .toggle-btn input[type="radio"]:checked + label i {
            color: white;
        }
        .toggle-btn label i {
            font-size: 0.85rem;
            color: var(--primary);
        }
        
        /* Section Headers */
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary-dark);
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid transparent;
            background: linear-gradient(90deg, var(--primary) 0%, transparent 100%);
            -webkit-background-clip: text;
            background-clip: text;
        }
        .section-title i {
            color: var(--primary);
        }
        
        /* Calculate Button */
        .btn-calculate {
            font-size: 1.3rem;
            padding: 15px 50px;
            border-radius: 50px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            box-shadow: 0 6px 20px rgba(40, 116, 166, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .btn-calculate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease;
        }
        .btn-calculate:hover::before {
            left: 100%;
        }
        .btn-calculate:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(40, 116, 166, 0.5);
        }
        .btn-calculate:active {
            transform: translateY(0);
        }
        
        /* Result Cards */
        .result-card {
            border-radius: 20px;
            padding: 12px 10px 5px 10px;
            text-align: center;
            min-height: 260px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            margin-bottom: 0;
        }
        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at top right, rgba(255,255,255,0.4) 0%, transparent 50%);
            pointer-events: none;
        }
        .result-card:hover {
            transform: translateY(-8px) scale(1.02);
        }
        .result-card .badge {
            font-size: 1.1rem;
            padding: 6px 14px;
            border-radius: 30px;
            font-weight: 700;
            margin-bottom: 6px;
            padding-bottom: 6px;
            letter-spacing: 0.5px;
            line-height: 1.4;
        }
        /* Increase emoji size in badges - target first character */
        .result-card .badge::first-letter {
            font-size: 2.2em;
            line-height: 0.7;
            vertical-align: -0.15em;
            display: inline-block;
            margin-right: 2px;
        }
        .result-card .specialty-name {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
            padding-bottom: 0;
        }
        .result-card .score-image-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin-top: 2px;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .result-card h2 {
            font-size: 2.7rem;
            font-weight: 800;
            margin: 0;
            margin-bottom: 0;
            padding-bottom: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.08);
            line-height: 1;
        }
        .result-card img {
            max-height: 150px;
            max-width: 150px;
            width: auto;
            height: auto;
            border-radius: 16px;
            margin: 0;
            margin-bottom: 0;
            padding-bottom: 0;
            transition: transform 0.3s ease;
            object-fit: contain;
            display: block;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75);
        }
        .result-card:hover img {
            transform: scale(1.05);
        }
        .result-img-frame {
            display: inline-block;
            margin: 0;
            margin-bottom: 0;
            padding-bottom: 0;
            transition: transform 0.3s ease;
            overflow: hidden;
            border-radius: 16px;
        }
        .result-card:hover .result-img-frame {
            transform: scale(1.05);
        }
        
        /* Medal Colors - Updated Design with Transparency */
        .gold {
            background: linear-gradient(180deg, rgba(255,249,196,0.9) 0%, rgba(255,235,59,0.85) 40%, rgba(255,193,7,0.9) 100%);
            border: none;
            box-shadow: 0 10px 40px rgba(255, 193, 7, 0.5);
        }
        .gold h2 { color: #5d4037; font-size: 3.2rem; }
        .gold .specialty-name { color: #5d4037; font-size: 1.5rem; }
        .gold .badge { 
            background: linear-gradient(135deg, #5d4037, #3e2723); 
            font-size: 1.1rem;
            padding: 10px 20px;
        }
        .gold .result-img-frame {
            border-radius: 18px;
            overflow: hidden;
        }
        .gold img { 
            max-height: 180px;
            max-width: 180px;
            border-radius: 18px;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75);
        }
        .gold h2 { font-size: 2.43rem; }
        
        .silver {
            background: linear-gradient(180deg, rgba(250,250,250,0.9) 0%, rgba(224,224,224,0.85) 40%, rgba(189,189,189,0.9) 100%);
            border: none;
            box-shadow: 0 8px 30px rgba(189, 189, 189, 0.5);
        }
        .silver h2 { color: #37474f; font-size: 2.52rem; }
        .silver .specialty-name { color: #37474f; font-size: 1.2rem; }
        .silver .badge { 
            background: linear-gradient(135deg, #455a64, #263238);
            font-size: 0.9rem;
        }
        .silver .result-img-frame {
            border-radius: 16px;
            overflow: hidden;
        }
        .silver img { 
            max-height: 170px;
            max-width: 170px;
            border-radius: 16px;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75);
        }
        
        .bronze {
            background: linear-gradient(180deg, rgba(255,224,178,0.9) 0%, rgba(255,171,64,0.85) 40%, rgba(255,145,0,0.9) 100%);
            border: none;
            box-shadow: 0 8px 30px rgba(255, 145, 0, 0.4);
        }
        .bronze h2 { color: #4e342e; font-size: 2.34rem; }
        .bronze .specialty-name { color: #4e342e; font-size: 1.1rem; }
        .bronze .badge { 
            background: linear-gradient(135deg, #5d4037, #3e2723);
            font-size: 0.85rem;
        }
        .bronze .result-img-frame {
            border-radius: 14px;
            overflow: hidden;
        }
        .bronze img { 
            max-height: 160px;
            max-width: 160px;
            border-radius: 14px;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75);
        }
        
        /* Tabs */
        .nav-tabs {
            border: none;
            gap: 5px;
            flex-wrap: wrap;
        }
        .nav-tabs .nav-link {
            border: none;
            border-radius: 10px;
            color: #666;
            font-weight: 500;
            padding: 10px 18px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        .nav-tabs .nav-link:hover {
            background: #e9ecef;
            color: var(--primary);
        }
        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 12px rgba(40, 116, 166, 0.3);
        }
        
        /* Tables */
        .table {
            border-radius: 12px;
            overflow: hidden;
        }
        .table thead th {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            font-weight: 600;
            border: none;
            padding: 15px;
        }
        .table tbody tr {
            transition: background 0.2s ease;
        }
        .table tbody tr:hover {
            background: rgba(40, 116, 166, 0.05);
        }
        .table tbody td {
            padding: 12px 15px;
            vertical-align: middle;
        }
        .rank-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-weight: 700;
            color: white;
        }
        .rank-1 { background: linear-gradient(135deg, #ffd700, #ffcc00); color: #8b6914; }
        .rank-2 { background: linear-gradient(135deg, #c0c0c0, #a8b0b8); color: #4a5568; }
        .rank-3 { background: linear-gradient(135deg, #cd7f32, #b8722c); }
        .rank-other { background: #e9ecef; color: #666; }
        
        /* Specialty Card */
        .specialty-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }
        .specialty-card h3 {
            color: var(--primary-dark);
            font-weight: 700;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--primary);
            margin-bottom: 15px;
        }
        .specialty-card h5 {
            color: var(--primary);
            font-weight: 600;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .specialty-card h5 i { font-size: 0.9rem; }
        
        /* Stats */
        .stat-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }
        .stat-card h2 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }
        .stat-card p {
            color: #666;
            font-weight: 500;
            margin: 5px 0 0;
        }
        
        /* Detail Image */
        .specialty-img-large {
            max-width: 95%;
            max-height: 400px;
            width: auto;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
            object-fit: contain;
            aspect-ratio: auto;
        }
        .specialty-img-large:hover {
            transform: scale(1.03);
        }
        
        /* Algorithm Cards */
        .algo-card {
            border-radius: 12px;
            padding: 20px;
            height: 100%;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .algo-card:hover {
            transform: translateY(-3px);
        }
        .algo-card.direct {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-color: var(--success);
        }
        .algo-card.proximity {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            border-color: var(--accent);
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-in {
            animation: fadeInUp 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            #results-cards .col-lg-5 { flex: 0 0 100%; max-width: 100%; }
            #results-cards .col-lg-3 { flex: 0 0 50%; max-width: 50%; }
            .result-img-frame {
                overflow: hidden !important;
                border-radius: 15px !important;
            }
            .gold .result-img-frame { border-radius: 17px !important; overflow: hidden !important; }
            .silver .result-img-frame { border-radius: 15px !important; overflow: hidden !important; }
            .bronze .result-img-frame { border-radius: 13px !important; overflow: hidden !important; }
            .result-card img { 
                max-height: 130px !important;
                max-width: 130px !important;
                border-radius: 15px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .gold img { 
                max-height: 150px !important; 
                max-width: 150px !important;
                border-radius: 17px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .silver img { 
                max-height: 140px !important; 
                max-width: 140px !important;
                border-radius: 15px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .bronze img { 
                max-height: 130px !important; 
                max-width: 130px !important;
                border-radius: 13px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .specialty-img-large { max-height: 320px; }
        }
        @media (max-width: 768px) {
            .header h1 { font-size: 1.6rem; }
            .result-card { 
                min-height: 180px !important; 
                padding: 12px 10px 5px 10px !important;
                margin-bottom: 0 !important;
            }
            .result-img-frame {
                overflow: hidden !important;
                border-radius: 14px !important;
            }
            .gold .result-img-frame { border-radius: 16px !important; overflow: hidden !important; }
            .silver .result-img-frame { border-radius: 14px !important; overflow: hidden !important; }
            .bronze .result-img-frame { border-radius: 12px !important; overflow: hidden !important; }
            .result-card h2 { font-size: 1.98rem !important; }
            .gold h2 { font-size: 2.16rem !important; }
            .silver h2 { font-size: 2.26rem !important; }
            .bronze h2 { font-size: 2.1rem !important; }
            .result-card .specialty-name { font-size: 1rem !important; margin-bottom: 6px !important; }
            .result-card .score-image-row { gap: 8px !important; }
            .result-card img { 
                max-height: 120px !important;
                max-width: 120px !important;
                border-radius: 14px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .gold img { 
                max-height: 140px !important; 
                max-width: 140px !important;
                border-radius: 16px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .silver img { 
                max-height: 130px !important; 
                max-width: 130px !important;
                border-radius: 14px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .bronze img { 
                max-height: 120px !important; 
                max-width: 120px !important;
                border-radius: 12px !important;
                filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2)) saturate(0.75) !important;
            }
            .specialty-img-large { max-height: 250px !important; }
            .btn-calculate { padding: 12px 30px; font-size: 1.1rem; }
            .nav-tabs .nav-link { padding: 8px 12px; font-size: 0.85rem; }
            .toggle-btn label { padding: 8px 14px; font-size: 0.85rem; }
            #results-cards { gap: 0.5rem !important; }
            #results-cards .col-lg-3 { flex: 0 0 100%; max-width: 100%; }
        }
        
        /* Loading State */
        .loading {
            position: relative;
            pointer-events: none;
        }
        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header text-center text-white mb-2">
        <h1><i class="fas fa-stethoscope me-2"></i>讘讜讞专 讛转诪讞讜转</h1>
        <p class="mb-0">诪讘讜住住 注诇 住拽专 367 诪转诪讞讬诐 讘专驻讜讗讛</p>
    </div>
    
    <div class="container-fluid px-2 px-md-3" style="max-width: 1400px;">
        
        <!-- Questionnaire Card -->
        <div class="card mb-2 animate-in">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-clipboard-list me-2"></i>讛砖讗诇讜谉 砖诇讬</h5>
            </div>
            <div class="card-body p-2">
                <!-- Personal Details Row -->
                <div class="section-title">
                    <i class="fas fa-user"></i>
                    <span>驻专讟讬诐 讗讬砖讬讬诐</span>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-md-3 col-6">
                        <label class="form-label fw-semibold mb-1">拽讘讜爪转 讙讬诇:</label>
                        <select id="age_group" class="form-select">
                            <option value="25-30">25-30</option>
                            <option value="30-35" selected>30-35</option>
                            <option value="35-40">35-40</option>
                            <option value="40+">40+</option>
                        </select>
                    </div>
                    <div class="col-md-3 col-6">
                        <label class="form-label fw-semibold">诪讙讚专:</label>
                        <div class="toggle-group mt-2">
                            <div class="toggle-btn">
                                <input type="radio" name="gender" id="male" value="male" checked>
                                <label for="male"><i class="fas fa-mars"></i> 讝讻专</label>
                            </div>
                            <div class="toggle-btn">
                                <input type="radio" name="gender" id="female" value="female">
                                <label for="female"><i class="fas fa-venus"></i> 谞拽讘讛</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">转讻谞讜谉 讛讜专讜转 讘讛转诪讞讜转:</label>
                        <div class="toggle-group mt-2">
                            <div class="toggle-btn">
                                <input type="radio" name="parenting" id="parenting_yes" value="yes">
                                <label for="parenting_yes"><i class="fas fa-check-circle"></i> 讻谉</label>
                            </div>
                            <div class="toggle-btn">
                                <input type="radio" name="parenting" id="parenting_no" value="no">
                                <label for="parenting_no"><i class="fas fa-times-circle"></i> 诇讗</label>
                            </div>
                            <div class="toggle-btn">
                                <input type="radio" name="parenting" id="parenting_maybe" value="maybe" checked>
                                <label for="parenting_maybe"><i class="fas fa-question-circle"></i> 讗讜诇讬</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Work Preferences -->
                <div class="section-title">
                    <i class="fas fa-briefcase"></i>
                    <span>讛注讚驻讜转 注讘讜讚讛</span>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-balance-scale me-1"></i>讗讬讝讜谉 讘讬转-注讘讜讚讛:</label>
                        <select id="pref_balance" class="form-select" onchange="updateSelect('balance')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3" selected>讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-shekel-sign me-1"></i>砖讻专:</label>
                        <select id="pref_salary" class="form-select" onchange="updateSelect('salary')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3" selected>讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-microscope me-1"></i>诪讞拽专/讗拽讚诪讬讛:</label>
                        <select id="pref_research" class="form-select" onchange="updateSelect('research')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2" selected>讞砖讜讘 诪注讟</option>
                            <option value="3">讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-heart me-1"></i>转讞讜砖转 诪砖诪注讜转:</label>
                        <select id="pref_meaning" class="form-select" onchange="updateSelect('meaning')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3">讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4" selected>讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                </div>
                
                <!-- Work Style -->
                <div class="section-title">
                    <i class="fas fa-cogs"></i>
                    <span>住讙谞讜谉 注讘讜讚讛</span>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-bolt me-1"></i>诪讜讻谞讜转 诇诇讞抓:</label>
                        <select id="pref_stress" class="form-select" onchange="updateSelect('stress')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3" selected>讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-hand-paper me-1"></i>注讘讜讚讛 讬讚谞讬转:</label>
                        <select id="pref_manual" class="form-select" onchange="updateSelect('manual')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3" selected>讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-user-friends me-1"></i>拽砖专 注诐 诪讟讜驻诇讬诐:</label>
                        <select id="pref_patient" class="form-select" onchange="updateSelect('patient')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3" selected>讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <label class="form-label fw-semibold"><i class="fas fa-moon me-1"></i>诪讜讻谞讜转 诇转讜专谞讜讬讜转:</label>
                        <select id="pref_shifts" class="form-select" onchange="updateSelect('shifts')">
                            <option value="1">诇讗 讞砖讜讘</option>
                            <option value="2">讞砖讜讘 诪注讟</option>
                            <option value="3" selected>讞砖讜讘 讘讬谞讜谞讬</option>
                            <option value="4">讞砖讜讘</option>
                            <option value="5">讞砖讜讘 诪讗讜讚</option>
                        </select>
                    </div>
                </div>
                
                <!-- Calculate Button -->
                <div class="text-center mt-2">
                    <button class="btn btn-primary btn-lg btn-calculate" onclick="calculate()">
                        <i class="fas fa-search me-2"></i>讞砖讘 讛转讗诪讛
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Results Cards - RTL Order: Gold (right) | Silver (middle) | Bronze (left) -->
        <div class="row g-2 mb-2 justify-content-center" id="results-cards">
            <!-- Gold - First Place (larger) -->
            <div class="col-lg-5 col-md-6">
                <div class="card result-card gold">
                    <span class="badge text-white">馃 诪拽讜诐 专讗砖讜谉</span>
                    <div class="specialty-name" id="name1">诇讞抓 注诇 "讞砖讘 讛转讗诪讛"</div>
                    <div class="score-image-row">
                        <h2 id="score1">?</h2>
                        <div class="result-img-frame" id="frame1" style="display:none;">
                            <img id="img1" src="" alt="">
                        </div>
                    </div>
                </div>
            </div>
            <!-- Silver - Second Place -->
            <div class="col-lg-3 col-md-6">
                <div class="card result-card silver">
                    <span class="badge text-white">馃 诪拽讜诐 砖谞讬</span>
                    <div class="specialty-name" id="name2">-</div>
                    <div class="score-image-row">
                        <h2 id="score2">?</h2>
                        <div class="result-img-frame" id="frame2" style="display:none;">
                            <img id="img2" src="" alt="">
                        </div>
                    </div>
                </div>
            </div>
            <!-- Bronze - Third Place -->
            <div class="col-lg-3 col-md-6">
                <div class="card result-card bronze">
                    <span class="badge text-white">馃 诪拽讜诐 砖诇讬砖讬</span>
                    <div class="specialty-name" id="name3">-</div>
                    <div class="score-image-row">
                        <h2 id="score3">?</h2>
                        <div class="result-img-frame" id="frame3" style="display:none;">
                            <img id="img3" src="" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tabs -->
        <div class="card mb-2">
            <div class="card-header">
                <ul class="nav nav-tabs card-header-tabs" role="tablist">
                    <li class="nav-item">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-ranking">
                            <i class="fas fa-list-ol me-1"></i>讚讬专讜讙 诪诇讗
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-charts">
                            <i class="fas fa-chart-pie me-1"></i>讛砖讜讜讗讛 讞讝讜转讬转
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-details">
                            <i class="fas fa-info-circle me-1"></i>驻专讟讬 讛转诪讞讜转
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-about">
                            <i class="fas fa-clipboard me-1"></i>讗讜讚讜转 讛砖讗诇讜谉
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-algorithm">
                            <i class="fas fa-calculator me-1"></i>讗讜讚讜转 讛诪讞砖讘讜谉
                        </button>
                    </li>
                </ul>
            </div>
            <div class="card-body p-2">
                <div class="tab-content">
                    <!-- Tab: Ranking -->
                    <div class="tab-pane fade show active" id="tab-ranking">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;">讚讬专讜讙</th>
                                        <th>讛转诪讞讜转</th>
                                        <th>爪讬讜谉 讛转讗诪讛</th>
                                        <th>砖讘讬注讜转 专爪讜谉</th>
                                        <th>讗讞讜讝 诪诪诇讬爪讬诐</th>
                                    </tr>
                                </thead>
                                <tbody id="ranking-body"></tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Tab: Charts -->
                    <div class="tab-pane fade" id="tab-charts">
                        <div class="row">
                            <div class="col-lg-6 mb-3">
                                <div id="radar-chart" style="height: 420px;"></div>
                            </div>
                            <div class="col-lg-6 mb-3">
                                <div id="bar-chart" style="height: 420px;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tab: Details -->
                    <div class="tab-pane fade" id="tab-details">
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label fw-semibold">讘讞专 讛转诪讞讜转 诇驻专讟讬诐:</label>
                                <select id="detail-specialty" class="form-select" onchange="showSpecialtyDetails()">
                                    <option value="讻讬专讜专讙讬转">讻讬专讜专讙讬转</option>
                                    <option value="驻谞讬诪讬转">驻谞讬诪讬转</option>
                                    <option value="诪砖驻讞讛">诪砖驻讞讛</option>
                                    <option value="讬诇讚讬诐">讬诇讚讬诐</option>
                                    <option value="驻住讬讻讬讗讟专讬讛">驻住讬讻讬讗讟专讬讛</option>
                                    <option value="讛专讚诪讛">讛专讚诪讛</option>
                                </select>
                            </div>
                        </div>
                        <div class="row g-3 mb-3">
                            <div class="col-lg-7">
                                <div class="specialty-card" id="specialty-info"></div>
                            </div>
                            <div class="col-lg-5 text-center d-flex align-items-center justify-content-center">
                                <img id="detail-img" class="specialty-img-large" src="" alt="">
                            </div>
                        </div>
                        <h5 class="text-primary mb-3"><i class="fas fa-chart-bar me-2"></i>讛砖讜讜讗讛: 驻专讜驻讬诇 讛讛转诪讞讜转 诪讜诇 讛讛注讚驻讜转 砖诇讱</h5>
                        <div id="compare-chart" style="height: 380px;"></div>
                    </div>
                    
                    <!-- Tab: About Survey -->
                    <div class="tab-pane fade" id="tab-about">
                        <h4 class="text-primary mb-3"><i class="fas fa-poll me-2"></i>讗讜讚讜转 讛住拽专</h4>
                        <p class="lead">砖讗诇讜谉 讝讛 诪讘讜住住 注诇 住拽专 诪拽讬祝 砖谞注专讱 讘拽专讘 诪转诪讞讬诐 讘专驻讜讗讛 讘讬砖专讗诇. 诪讟专转 讛住拽专 讛讬讬转讛 诇讘讞讜谉 讗转 讛讙讜专诪讬诐 讛诪砖驻讬注讬诐 注诇 讘讞讬专转 讛转诪讞讜转, 砖讘讬注讜转 专爪讜谉 诪转讛诇讬讱 讛讛转诪讞讜转, 讜讗讬讝讜谉 讞讬讬诐-注讘讜讚讛.</p>
                        
                        <hr class="my-4">
                        
                        <h5 class="text-primary mb-3"><i class="fas fa-chart-line me-2"></i>谞转讜谞讬诐 讻诇诇讬讬诐</h5>
                        <div class="row g-3 mb-3">
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <h2>367</h2>
                                    <p>诪砖转转驻讬诐</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <h2>72%</h2>
                                    <p>砖讬注讜专 讛讬注谞讜转</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <h2>74%</h2>
                                    <p>诪诪诇讬爪讬诐 注诇 讛讛转诪讞讜转</p>
                                </div>
                            </div>
                        </div>
                        
                        <h5 class="text-primary mb-3"><i class="fas fa-users me-2"></i>住讟讟讬住讟讬拽讛 转讬讗讜专讬转</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="specialty-card">
                                    <h6 class="fw-bold"><i class="fas fa-venus-mars me-2"></i>讚诪讜讙专驻讬讛</h6>
                                    <ul class="mb-0">
                                        <li>谞砖讬诐: 58%, 讙讘专讬诐: 42%</li>
                                        <li>讙讬诇 诪诪讜爪注: 32.4 (讟讜讜讞: 25-55)</li>
                                        <li>讛讜专讬诐 讘诪讛诇讱 讛讛转诪讞讜转: 38%</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="specialty-card">
                                    <h6 class="fw-bold"><i class="fas fa-hospital me-2"></i>讛转驻诇讙讜转 讛转诪讞讜讬讜转</h6>
                                    <ul class="mb-0">
                                        <li>讻讬专讜专讙讬讜转: 28%</li>
                                        <li>诇讗-讻讬专讜专讙讬讜转: 69%</li>
                                        <li>讗讞专: 3%</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div id="gender-pie" style="height: 280px;"></div>
                            </div>
                            <div class="col-md-6">
                                <div id="specialty-pie" style="height: 280px;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tab: Algorithm -->
                    <div class="tab-pane fade" id="tab-algorithm">
                        <h4 class="text-primary mb-3"><i class="fas fa-cog me-2"></i>讗讬讱 诪讞讜砖讘 爪讬讜谉 讛讛转讗诪讛?</h4>
                        <p class="lead">讛诪讞砖讘讜谉 诪砖转诪砖 讘讗诇讙讜专讬转诐 讛诪砖拽诇诇 讗转 讛讛注讚驻讜转 砖诇讱 诪讜诇 谞转讜谞讬 讛住拽专 讛讗诪讬转讬讬诐 砖诇 诪转诪讞讬诐 讘讻诇 讛转诪讞讜转.</p>
                        
                        <hr class="my-4">
                        
                        <h5 class="text-primary mb-3"><i class="fas fa-balance-scale-right me-2"></i>砖诇讘 1: 诪砖拽诇讜转 诇驻讬 讛注讚驻讜转</h5>
                        <p>讻诇 拽专讬讟专讬讜谉 诪拽讘诇 诪砖拽诇 讬讞住讬 诇驻讬 讛讞砖讬讘讜转 砖谞转转 诇讜 (1-5):</p>
                        <ul>
                            <li>讗诐 谞转转 <strong>5</strong> 诇讗讬讝讜谉 讜-<strong>1</strong> 诇砖讻专 鈫?讗讬讝讜谉 讬砖驻讬注 驻讬 5 讬讜转专 注诇 讛爪讬讜谉</li>
                            <li>讛诪砖拽诇讜转 诪谞讜专诪诇讬诐 讻讱 砖住讻讜诪诐 讬讛讬讛 100%</li>
                        </ul>
                        <div class="alert alert-info d-flex align-items-center">
                            <i class="fas fa-code me-3 fs-4"></i>
                            <code class="fs-6">诪砖拽诇 = (爪讬讜谉 砖谞转转 / 5) / 住讻讜诐 讻诇 讛爪讬讜谞讬诐</code>
                        </div>
                        
                        <hr class="my-4">
                        
                        <h5 class="text-primary mb-3"><i class="fas fa-calculator me-2"></i>砖诇讘 2: 讞讬砖讜讘 讛转讗诪讛 诇讻诇 拽专讬讟专讬讜谉</h5>
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <div class="algo-card direct">
                                    <h6 class="fw-bold text-success"><i class="fas fa-arrow-up me-2"></i>拽专讬讟专讬讜谞讬诐 讬砖讬专讬诐</h6>
                                    <small class="text-muted">讻讻诇 砖讛讛转诪讞讜转 讙讘讜讛讛 讬讜转专 - 讬讜转专 讟讜讘</small>
                                    <ul class="mt-2 mb-2">
                                        <li>讗讬讝讜谉 讘讬转-注讘讜讚讛</li>
                                        <li>砖讻专</li>
                                        <li>诪讞拽专/讗拽讚诪讬讛</li>
                                        <li>转讞讜砖转 诪砖诪注讜转</li>
                                    </ul>
                                    <code>讛转讗诪讛 = 爪讬讜谉 讛讛转诪讞讜转 / 5</code>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="algo-card proximity">
                                    <h6 class="fw-bold text-warning"><i class="fas fa-bullseye me-2"></i>拽专讬讟专讬讜谞讬诐 砖诇 拽专讘讛</h6>
                                    <small class="text-muted">讻讻诇 砖讛讛转诪讞讜转 拽专讜讘讛 诇讛注讚驻讛 - 讬讜转专 讟讜讘</small>
                                    <ul class="mt-2 mb-2">
                                        <li>注讘讜讚讛 讬讚谞讬转</li>
                                        <li>拽砖专 注诐 诪讟讜驻诇讬诐</li>
                                        <li>诪讜讻谞讜转 诇转讜专谞讜讬讜转</li>
                                    </ul>
                                    <code>讛转讗诪讛 = 1 - |讛注讚驻讛 - 爪讬讜谉| / 4</code>
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <h5 class="text-primary mb-3"><i class="fas fa-trophy me-2"></i>砖诇讘 3: 爪讬讜谉 住讜驻讬</h5>
                        <div class="alert alert-secondary d-flex align-items-center">
                            <i class="fas fa-sigma me-3 fs-4"></i>
                            <code class="fs-5">爪讬讜谉 = 危 (诪砖拽诇 脳 讛转讗诪讛 脳 100)</code>
                        </div>
                        
                        <div class="alert alert-warning mt-4">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>讛注专讛:</strong> 讛诪讞砖讘讜谉 谞讜注讚 诇住讬讬注 讘讛转诪爪讗讜转 专讗砖讜谞讬转 讘诇讘讚. 诪讜诪诇抓 诇砖讜讞讞 注诐 诪转诪讞讬诐 讜讘讜讙专讬诐 讘转讞讜诪讬诐 砖诪注谞讬讬谞讬诐 讗讜转讱.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="text-center text-muted py-4">
            <small>诪讞拽专 讘讞讬专转 讛转诪讞讜转 讘专驻讜讗讛 漏 2026 | 诪讘讜住住 注诇 谞转讜谞讬 住拽专 讗诪讬转讬讬诐</small>
        </footer>
        
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
    // ==========================================
    // DATA - Specialty Profiles (IDENTICAL TO SHINY APP)
    // ==========================================
    
    const specialtyProfiles = [
        {
            name: "讻讬专讜专讙讬转",
            image: "prop_img_for_app/讻讬专讜专讙讬转.jpg",
            avg_balance: 2.3, avg_stress: 2.0, avg_shifts: 6.5, avg_research: 3.2,
            avg_meaning: 4.0, avg_teamwork: 4.2, avg_manual: 4.8, avg_patient_contact: 3.5,
            avg_salary: 3.8, avg_satisfaction: 3.6, avg_bureaucracy: 2.8,
            pct_recommend: 72, pct_parenting: 25,
            fellowship_importance: 4.0, community_work: 1.5, private_work: 3.5,
            description: "讛转诪讞讜讬讜转 讻讬专讜专讙讬讜转 讻讜诇诇讜转 注讘讜讚讛 讬讚谞讬转 讗讬谞讟谞住讬讘讬转, 转讜专谞讜讬讜转 专讘讜转, 讜诇讞抓 讙讘讜讛. 诪转讗讬诐 诇诪讬 砖讗讜讛讘 驻注讜诇讛, 转讜爪讗讜转 诪讬讬讚讬讜转 讜注讘讜讚转 爪讜讜转."
        },
        {
            name: "驻谞讬诪讬转",
            image: "prop_img_for_app/驻谞讬诪讬转.png",
            avg_balance: 2.6, avg_stress: 2.4, avg_shifts: 5.0, avg_research: 3.5,
            avg_meaning: 3.8, avg_teamwork: 3.8, avg_manual: 2.2, avg_patient_contact: 4.0,
            avg_salary: 3.2, avg_satisfaction: 3.4, avg_bureaucracy: 3.8,
            pct_recommend: 65, pct_parenting: 35,
            fellowship_importance: 3.5, community_work: 2.5, private_work: 3.0,
            description: "专驻讜讗讛 驻谞讬诪讬转 诪讗讜驻讬讬谞转 讘讞砖讬讘讛 讗谞诇讬讟讬转, 拽砖专 诪转诪砖讱 注诐 诪讟讜驻诇讬诐, 讜注讜诪住 讘讬专讜拽专讟讬. 诪转讗讬诐 诇诪讬 砖讗讜讛讘 诇驻转讜专 讞讬讚讜转 专驻讜讗讬讜转."
        },
        {
            name: "诪砖驻讞讛",
            image: "prop_img_for_app/诪砖驻讞讛.png",
            avg_balance: 4.1, avg_stress: 3.9, avg_shifts: 2.0, avg_research: 2.0,
            avg_meaning: 3.9, avg_teamwork: 3.2, avg_manual: 1.8, avg_patient_contact: 4.5,
            avg_salary: 3.5, avg_satisfaction: 4.0, avg_bureaucracy: 2.5,
            pct_recommend: 82, pct_parenting: 55,
            fellowship_importance: 1.5, community_work: 4.5, private_work: 4.0,
            description: "专驻讜讗转 诪砖驻讞讛 诪爪讬注讛 讗讬讝讜谉 讘讬转-注讘讜讚讛 诪爪讜讬谉, 拽砖专 讗专讜讱 讟讜讜讞 注诐 诪讟讜驻诇讬诐, 讜讗驻砖专讜讬讜转 注讘讜讚讛 讘拽讛讬诇讛. 诪转讗讬诐 诇诪讬 砖诪注讚讬祝 讬爪讬讘讜转."
        },
        {
            name: "讬诇讚讬诐",
            image: "prop_img_for_app/讬诇讚讬诐.png",
            avg_balance: 3.4, avg_stress: 3.3, avg_shifts: 4.0, avg_research: 2.8,
            avg_meaning: 4.1, avg_teamwork: 3.9, avg_manual: 2.5, avg_patient_contact: 4.2,
            avg_salary: 3.0, avg_satisfaction: 3.8, avg_bureaucracy: 3.2,
            pct_recommend: 78, pct_parenting: 45,
            fellowship_importance: 2.5, community_work: 3.0, private_work: 3.2,
            description: "专驻讜讗转 讬诇讚讬诐 诪讗讜驻讬讬谞转 讘注讘讜讚讛 注诐 讗讜讻诇讜住讬讬讛 讬讬讞讜讚讬转, 转讞讜砖转 诪砖诪注讜转 讙讘讜讛讛, 讜讗讬讝讜谉 住讘讬专. 诪转讗讬诐 诇诪讬 砖讗讜讛讘 诇注讘讜讚 注诐 讬诇讚讬诐 讜诪砖驻讞讜转."
        },
        {
            name: "驻住讬讻讬讗讟专讬讛",
            image: "prop_img_for_app/驻住讬讻讬讗讟专讬讛.png",
            avg_balance: 3.8, avg_stress: 3.5, avg_shifts: 3.0, avg_research: 2.5,
            avg_meaning: 4.0, avg_teamwork: 3.5, avg_manual: 1.5, avg_patient_contact: 4.8,
            avg_salary: 3.3, avg_satisfaction: 3.7, avg_bureaucracy: 2.2,
            pct_recommend: 75, pct_parenting: 42,
            fellowship_importance: 2.0, community_work: 3.5, private_work: 4.2,
            description: "驻住讬讻讬讗讟专讬讛 诪爪讬注讛 拽砖专 注诪讜拽 注诐 诪讟讜驻诇讬诐, 注讘讜讚讛 诇诇讗 诇讞抓 驻讬讝讬, 讜讗驻砖专讜讬讜转 诇注讘讜讚讛 驻专讟讬转. 诪转讗讬诐 诇诪讬 砖诪注讜谞讬讬谉 讘爪讚 讛谞驻砖讬 砖诇 讛专驻讜讗讛."
        },
        {
            name: "讛专讚诪讛",
            image: "prop_img_for_app/讛专讚诪讛.png",
            avg_balance: 3.2, avg_stress: 2.8, avg_shifts: 5.5, avg_research: 2.2,
            avg_meaning: 3.5, avg_teamwork: 4.5, avg_manual: 3.8, avg_patient_contact: 2.0,
            avg_salary: 4.2, avg_satisfaction: 3.5, avg_bureaucracy: 2.0,
            pct_recommend: 70, pct_parenting: 38,
            fellowship_importance: 2.8, community_work: 1.8, private_work: 2.5,
            description: "讛专讚诪讛 诪讗讜驻讬讬谞转 讘注讘讜讚转 爪讜讜转 讗讬谞讟谞住讬讘讬转, 砖讻专 讙讘讜讛 讬讞住讬转, 讜驻讞讜转 拽砖专 讬砖讬专 注诐 诪讟讜驻诇讬诐. 诪转讗讬诐 诇诪讬 砖讗讜讛讘 讟讻谞讬讜转 讜驻注讜诇讛."
        }
    ];
    
    let results = [];
    
    // ==========================================
    // SELECT UPDATE (replaced sliders with text options)
    // ==========================================
    
    function updateSelect(name) {
        // Function kept for compatibility, but no longer needed
        // since we're using select dropdowns instead of sliders
    }
    
    // ==========================================
    // CALCULATE MATCH SCORE (IDENTICAL TO SHINY APP)
    // ==========================================
    
    function calculateMatchScore(userPrefs, specialty) {
        // Step 1: Calculate weights (identical to R: user_prefs$pref_X / 5)
        const weights = {
            balance: userPrefs.balance / 5,
            salary: userPrefs.salary / 5,
            research: userPrefs.research / 5,
            meaning: userPrefs.meaning / 5,
            stress: userPrefs.stress / 5,
            manual: userPrefs.manual / 5,
            patient_contact: userPrefs.patient / 5,
            shifts: userPrefs.shifts / 5
        };
        
        // Normalize weights (identical to R: w / total_weight)
        const totalWeight = Object.values(weights).reduce((a, b) => a + b, 0);
        Object.keys(weights).forEach(k => weights[k] /= totalWeight);
        
        let score = 0;
        
        // Direct criteria (identical to R)
        // 讗讬讝讜谉 - 讛转讗诪讛 讬砖讬专讛
        score += weights.balance * (specialty.avg_balance / 5) * 100;
        
        // 砖讻专 - 讛转讗诪讛 讬砖讬专讛
        score += weights.salary * (specialty.avg_salary / 5) * 100;
        
        // 诪讞拽专 - 讛转讗诪讛 讬砖讬专讛
        score += weights.research * (specialty.avg_research / 5) * 100;
        
        // 诪砖诪注讜转 - 讛转讗诪讛 讬砖讬专讛
        score += weights.meaning * (specialty.avg_meaning / 5) * 100;
        
        // 住讟专住 - 讛转讗诪讛 讛驻讜讻讛 (identical to R logic)
        let stressMatch;
        if (userPrefs.stress >= 3) {
            stressMatch = (6 - specialty.avg_stress) / 5;
        } else {
            stressMatch = specialty.avg_stress / 5;
        }
        score += weights.stress * stressMatch * 100;
        
        // 注讘讜讚讛 讬讚谞讬转 - 拽专讘讛 (identical to R: 1 - abs(...) / 4)
        const manualMatch = 1 - Math.abs(userPrefs.manual - specialty.avg_manual) / 4;
        score += weights.manual * manualMatch * 100;
        
        // 拽砖专 注诐 诪讟讜驻诇讬诐 - 拽专讘讛 (identical to R)
        const contactMatch = 1 - Math.abs(userPrefs.patient - specialty.avg_patient_contact) / 4;
        score += weights.patient_contact * contactMatch * 100;
        
        // 转讜专谞讜讬讜转 - 讛转讗诪讛 诇驻讬 讛注讚驻讛 (identical to R normalization)
        const shiftsNormalized = (specialty.avg_shifts - 2) / 6.5;  // 谞讜专诪诇讬讝爪讬讛 诇-0-1
        const shiftsPrefNormalized = (userPrefs.shifts - 1) / 4;
        const shiftsMatch = 1 - Math.abs(shiftsPrefNormalized - shiftsNormalized);
        score += weights.shifts * shiftsMatch * 100;
        
        // 讘讜谞讜住 诇讛讜专讜转 (identical to R)
        if (userPrefs.parenting === 'yes') {
            score *= (1 + (specialty.pct_parenting / 100 - 0.35) * 0.2);
        }
        
        return Math.round(score * 10) / 10;
    }
    
    // ==========================================
    // MAIN CALCULATE FUNCTION
    // ==========================================
    
    function calculate() {
        const userPrefs = {
            balance: parseInt(document.getElementById('pref_balance').value),
            salary: parseInt(document.getElementById('pref_salary').value),
            research: parseInt(document.getElementById('pref_research').value),
            meaning: parseInt(document.getElementById('pref_meaning').value),
            stress: parseInt(document.getElementById('pref_stress').value),
            manual: parseInt(document.getElementById('pref_manual').value),
            patient: parseInt(document.getElementById('pref_patient').value),
            shifts: parseInt(document.getElementById('pref_shifts').value),
            parenting: document.querySelector('input[name="parenting"]:checked').value
        };
        
        // Calculate scores
        results = specialtyProfiles.map(spec => ({
            ...spec,
            score: calculateMatchScore(userPrefs, spec)
        })).sort((a, b) => b.score - a.score);
        
        // Animate result cards
        const cards = document.querySelectorAll('.result-card');
        cards.forEach((card, i) => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
                card.style.transition = 'all 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, i * 150);
        });
        
        // Update top 3 cards
        for (let i = 0; i < 3; i++) {
            document.getElementById(`score${i+1}`).textContent = results[i].score + '%';
            document.getElementById(`name${i+1}`).textContent = results[i].name;
            const img = document.getElementById(`img${i+1}`);
            const frame = document.getElementById(`frame${i+1}`);
            img.src = results[i].image;
            img.onload = () => {
                img.style.display = 'block';
                frame.style.display = 'inline-block';
            };
            img.onerror = () => {
                img.style.display = 'none';
                frame.style.display = 'none';
            };
        }
        
        // Update ranking table
        updateRankingTable();
        
        // Update charts
        updateCharts();
        
        // Update specialty details
        showSpecialtyDetails();
    }
    
    // ==========================================
    // UPDATE RANKING TABLE
    // ==========================================
    
    function updateRankingTable() {
        const tbody = document.getElementById('ranking-body');
        tbody.innerHTML = results.map((r, i) => {
            const rankClass = i === 0 ? 'rank-1' : i === 1 ? 'rank-2' : i === 2 ? 'rank-3' : 'rank-other';
            return `
                <tr>
                    <td><span class="rank-badge ${rankClass}">${i + 1}</span></td>
                    <td><strong>${r.name}</strong></td>
                    <td><span class="badge bg-primary fs-6">${r.score}%</span></td>
                    <td>${r.avg_satisfaction}/5 猸?/td>
                    <td>${r.pct_recommend}%</td>
                </tr>
            `;
        }).join('');
    }
    
    // ==========================================
    // UPDATE CHARTS
    // ==========================================
    
    function updateCharts() {
        if (results.length === 0) return;
        
        const top3 = results.slice(0, 3);
        const categories = ['讗讬讝讜谉', '砖讻专', '诪讞拽专', '诪砖诪注讜转', '专讜讙注', '拽砖专 诪讟讜驻诇讬诐'];
        
        // Radar Chart
        const radarData = top3.map((spec, i) => ({
            type: 'scatterpolar',
            r: [spec.avg_balance, spec.avg_salary, spec.avg_research, spec.avg_meaning, spec.avg_stress, spec.avg_patient_contact],
            theta: categories,
            fill: 'toself',
            name: `${spec.name} (${spec.score}%)`,
            fillcolor: ['rgba(255,215,0,0.3)', 'rgba(192,192,192,0.3)', 'rgba(205,127,50,0.3)'][i],
            line: { color: ['#ffd700', '#c0c0c0', '#cd7f32'][i], width: 3 }
        }));
        
        Plotly.newPlot('radar-chart', radarData, {
            polar: { 
                radialaxis: { visible: true, range: [0, 5], tickfont: { size: 10 } },
                angularaxis: { tickfont: { size: 12 } }
            },
            showlegend: true,
            legend: { x: 0.5, y: -0.15, orientation: 'h', xanchor: 'center' },
            title: { text: '讛砖讜讜讗转 驻专讜驻讬诇讬诐 - 3 讛转诪讞讜讬讜转 诪讜讘讬诇讜转', font: { size: 16 } },
            margin: { t: 60, b: 80 }
        }, { responsive: true });
        
        // Bar Chart
        const colors = results.map((r, i) => {
            if (i === 0) return '#ffd700';
            if (i === 1) return '#c0c0c0';
            if (i === 2) return '#cd7f32';
            return '#3498db';
        });
        
        Plotly.newPlot('bar-chart', [{
            x: results.map(r => r.name),
            y: results.map(r => r.score),
            type: 'bar',
            marker: { 
                color: colors,
                line: { color: colors.map(c => c === '#3498db' ? '#2874a6' : c), width: 2 }
            },
            text: results.map(r => r.score + '%'),
            textposition: 'outside',
            textfont: { size: 14, weight: 'bold' }
        }], {
            xaxis: { title: { text: '讛转诪讞讜转', font: { size: 14 } }, tickfont: { size: 12 } },
            yaxis: { title: { text: '爪讬讜谉 讛转讗诪讛 (%)', font: { size: 14 } }, range: [0, 105], tickfont: { size: 12 } },
            title: { text: '讚讬专讜讙 讻诇 讛讛转诪讞讜讬讜转', font: { size: 16 } },
            margin: { t: 60, b: 80 }
        }, { responsive: true });
    }
    
    // ==========================================
    // SPECIALTY DETAILS
    // ==========================================
    
    function showSpecialtyDetails() {
        const specName = document.getElementById('detail-specialty').value;
        const spec = specialtyProfiles.find(s => s.name === specName);
        if (!spec) return;
        
        // Find rank
        const rank = results.findIndex(r => r.name === specName) + 1;
        const rankText = rank > 0 ? `诪拽讜诐 ${rank} 讘讚讬专讜讙 砖诇讱` : '';
        
        // Update info card
        document.getElementById('specialty-info').innerHTML = `
            <h3><i class="fas fa-hospital-user me-2"></i>${spec.name}</h3>
            ${rankText ? `<span class="badge bg-primary mb-3">${rankText}</span>` : ''}
            <p class="lead">${spec.description}</p>
            <hr>
            <div class="row">
                <div class="col-md-4">
                    <h5><i class="fas fa-chart-bar"></i> 谞转讜谞讬诐 讻诇诇讬讬诐</h5>
                    <p><i class="fas fa-star text-warning me-2"></i><strong>砖讘讬注讜转 专爪讜谉:</strong> ${spec.avg_satisfaction}/5</p>
                    <p><i class="fas fa-thumbs-up text-success me-2"></i><strong>讗讞讜讝 诪诪诇讬爪讬诐:</strong> ${spec.pct_recommend}%</p>
                    <p><i class="fas fa-baby text-info me-2"></i><strong>讗讞讜讝 讛讜专讬诐:</strong> ${spec.pct_parenting}%</p>
                </div>
                <div class="col-md-4">
                    <h5><i class="fas fa-weight-hanging"></i> 注讜诪住讬诐</h5>
                    <p><i class="fas fa-moon text-secondary me-2"></i><strong>转讜专谞讜讬讜转/讞讜讚砖:</strong> ${spec.avg_shifts}</p>
                    <p><i class="fas fa-bolt text-danger me-2"></i><strong>专诪转 住讟专住:</strong> ${spec.avg_stress}/5</p>
                    <p><i class="fas fa-file-alt text-muted me-2"></i><strong>注讜诪住 讘讬专讜拽专讟讬:</strong> ${spec.avg_bureaucracy}/5</p>
                </div>
                <div class="col-md-4">
                    <h5><i class="fas fa-door-open"></i> 讛讝讚诪谞讜讬讜转</h5>
                    <p><i class="fas fa-microscope text-primary me-2"></i><strong>讗驻砖专讜转 诇诪讞拽专:</strong> ${spec.avg_research}/5</p>
                    <p><i class="fas fa-briefcase-medical text-success me-2"></i><strong>注讘讜讚讛 驻专讟讬转:</strong> ${spec.private_work}/5</p>
                    <p><i class="fas fa-users text-info me-2"></i><strong>注讘讜讚讛 讘拽讛讬诇讛:</strong> ${spec.community_work}/5</p>
                </div>
            </div>
        `;
        
        // Update image
        const img = document.getElementById('detail-img');
        img.src = spec.image;
        img.onerror = () => img.style.display = 'none';
        img.onload = () => img.style.display = 'block';
        
        // Update comparison chart
        const userPrefs = {
            balance: parseInt(document.getElementById('pref_balance').value),
            salary: parseInt(document.getElementById('pref_salary').value),
            research: parseInt(document.getElementById('pref_research').value),
            meaning: parseInt(document.getElementById('pref_meaning').value),
            stress: parseInt(document.getElementById('pref_stress').value),
            manual: parseInt(document.getElementById('pref_manual').value),
            patient: parseInt(document.getElementById('pref_patient').value)
        };
        
        const metrics = ['讗讬讝讜谉', '砖讻专', '诪讞拽专', '诪砖诪注讜转', '专讜讙注', '注讘讜讚讛 讬讚谞讬转', '拽砖专 诪讟讜驻诇讬诐'];
        const specValues = [spec.avg_balance, spec.avg_salary, spec.avg_research, spec.avg_meaning, spec.avg_stress, spec.avg_manual, spec.avg_patient_contact];
        const userValues = [userPrefs.balance, userPrefs.salary, userPrefs.research, userPrefs.meaning, userPrefs.stress, userPrefs.manual, userPrefs.patient];
        
        Plotly.newPlot('compare-chart', [
            { 
                x: metrics, y: specValues, type: 'bar', name: '驻专讜驻讬诇 讛讛转诪讞讜转', 
                marker: { color: '#3498db', line: { color: '#2874a6', width: 2 } }
            },
            { 
                x: metrics, y: userValues, type: 'bar', name: '讛讛注讚驻讜转 砖诇讱', 
                marker: { color: '#e74c3c', line: { color: '#c0392b', width: 2 } }
            }
        ], {
            barmode: 'group',
            xaxis: { tickfont: { size: 12 } },
            yaxis: { title: '爪讬讜谉 (1-5)', range: [0, 5.5], tickfont: { size: 12 } },
            legend: { orientation: 'h', y: -0.2, xanchor: 'center', x: 0.5 },
            title: { text: `讛砖讜讜讗讛: ${spec.name}`, font: { size: 16 } },
            margin: { t: 50, b: 100 }
        }, { responsive: true });
    }
    
    // ==========================================
    // ABOUT CHARTS (Static)
    // ==========================================
    
    function initAboutCharts() {
        // Gender pie
        Plotly.newPlot('gender-pie', [{
            labels: ['谞砖讬诐', '讙讘专讬诐'],
            values: [58, 42],
            type: 'pie',
            marker: { colors: ['#e74c3c', '#3498db'], line: { color: '#fff', width: 2 } },
            textinfo: 'label+percent',
            textfont: { size: 14 },
            hole: 0.4
        }], { 
            title: { text: '讛转驻诇讙讜转 诪讙讚专讬转', font: { size: 16 } }, 
            showlegend: false,
            margin: { t: 50, b: 20 }
        }, { responsive: true });
        
        // Specialty pie
        Plotly.newPlot('specialty-pie', [{
            labels: ['讻讬专讜专讙讬转', '诇讗-讻讬专讜专讙讬转', '讗讞专'],
            values: [28, 69, 3],
            type: 'pie',
            marker: { colors: ['#27ae60', '#3498db', '#95a5a6'], line: { color: '#fff', width: 2 } },
            textinfo: 'label+percent',
            textfont: { size: 14 },
            hole: 0.4
        }], { 
            title: { text: '讛转驻诇讙讜转 拽讟讙讜专讬讜转', font: { size: 16 } }, 
            showlegend: false,
            margin: { t: 50, b: 20 }
        }, { responsive: true });
    }
    
    // ==========================================
    // INIT
    // ==========================================
    
    document.addEventListener('DOMContentLoaded', () => {
        initAboutCharts();
        showSpecialtyDetails();
        
        // Trigger initial calculation
        setTimeout(calculate, 500);
    });
    </script>
</body>
</html>
